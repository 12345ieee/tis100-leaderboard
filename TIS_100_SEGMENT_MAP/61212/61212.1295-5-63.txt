@0


@1
S: MOV   1 ACC
   SUB RIGHT
   JEZ Z
N: MOV UP ACC
   JMP A
Z: MOV RIGHT NIL
   MOV RIGHT RIGHT
   MOV UP  RIGHT
   JMP S
A: SUB RIGHT
E: JLZ L
   MOV  -2 RIGHT
   JMP A
L: MOV   3 RIGHT
   MOV ACC RIGHT

@2
MOV UP   ACC
MOV ACC LEFT
SAV
ADD ACC
ADD ACC
ADD ACC
MOV ACC  LEFT
MOV   1  ANY
JRO LEFT
MOV  7  DOWN
JRO 99
MOV  3 DOWN
SWP
MOV ACC  DOWN
MOV LEFT DOWN

@3


@4


@5
S: MOV  -1 ACC
J: JRO UP
   ADD 8
   JMP J
N: MOV ACC DOWN
   MOV UP  DOWN
   MOV UP  DOWN
   JMP S
   MOV  UP DOWN
   MOV   0 DOWN
   MOV   0 DOWN

@6


@7
 MOV 1 ACC
 ADD RIGHT
 SAV
 MOV RIGHT ACC
 JRO 3
  SWP
  MOV ACC RIGHT
  SWP
 SUB 1
JRO RIGHT

MOV ACC DOWN

@8
MOV UP LEFT
MOV ANY ACC
MOV ACC LEFT
ADD LAST
JLZ L
JMP E

L: MOV -4 ANY
M: ADD LAST
   JLZ L
E: MOV 1 LEFT
   MOV ACC DOWN
