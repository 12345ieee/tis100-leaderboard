@0
MOV ACC DOWN #B
MOV RIGHT DOWN #A
MOV RIGHT ACC #B
MOV ACC DOWN #B

#109/11/64

@1
MOV UP LAST
MOV UP ANY

@2
MOV LEFT ACC #C
ADD 9
MOV LEFT RIGHT #D
MOV ACC RIGHT #C+9
MOV ACC DOWN #C+9

@3
MOV ACC DOWN #D
MOV LEFT ACC #D
SAV
SUB LEFT #C+9
MOV ACC DOWN#D-C-9
SWP

@4
MOV -9 ACC
MOV UP LAST #B
ADD UP #A
MOV ACC ANY #A-9
SUB UP #B
MOV ACC ANY #A-B-9

@5
MOV LEFT ANY

@6
# PROCESS B-C-9

D: MOV LEFT RIGHT
B: MOV 1 DOWN
A: MOV LEFT ACC #B
SUB UP #C+9
JGZ D
MOV LEFT RIGHT#A-9
ADD 18
JLZ B
C: MOV 0 DOWN
JMP A #CHECK

@7
# PROCESS A-D-9

MOV LEFT ACC #A-9
SUB UP #D
JGZ B
ADD 19
JGZ C
B: MOV 1 DOWN
JMP A #CHECK
C: MOV 0 DOWN
A:MOV UP DOWN#DC-9

@8
# PROCESS A-B-9

A:MOV UP ACC#A-B-9
JGZ B
ADD 19
JGZ C
B: MOV 1 RIGHT
JMP A
C: MOV 0 RIGHT

@9
MOV UP LAST
MOV RIGHT ANY
MOV RIGHT DOWN
MOV LEFT DOWN

@10
# PROCESS D-C-9

C: MOV 0 LEFT
MOV UP LEFT
MOV UP ACC #D-C-9
A: JGZ B
ADD 19
JGZ C
B: MOV 1 LEFT
MOV UP LEFT
MOV UP ACC #D-C-9
JMP A #CHECK
